local a=workspace.CurrentCamera;local b=game:GetService("Players")local c=b.LocalPlayer;local d=c:GetMouse()local e=Vector3.new;local f=a.WorldToViewportPoint;local function g(h,i)local j=Drawing.new(h)i=i or{}for k,l in pairs(i)do j[k]=l end;return j end;function ESP:GetTeam(m)local n=self.Overrides.GetTeam;if n then return n(m)end;return m and m.Team end;function ESP:IsTeamMate(m)local n=self.Overrides.IsTeamMate;if n then return n(m)end;return self:GetTeam(m)==self:GetTeam(c)end;function ESP:GetColor(h)local n=self.Overrides.GetColor;if n then return n(h)end;local m=self:GetPlrFromChar(h)return m and self.TeamColor and m.Team and m.Team.TeamColor.Color or self.Color end;function ESP:GetPlrFromChar(o)local n=self.Overrides.GetPlrFromChar;if n then return n(o)end;return b:GetPlayerFromCharacter(o)end;function ESP:Toggle(p)self.Enabled=p;if not p then for k,l in pairs(self.Objects)do if l.Type=="Box"then if l.Temporary then l:Remove()else for k,l in pairs(l.Components)do l.Visible=false end end end end end end;function ESP:GetBox(h)return self.Objects[h]end;function ESP:AddObjectListener(q,r)local function s(t)if type(r.Type)=="string"and t:IsA(r.Type)or r.Type==nil then if type(r.Name)=="string"and t.Name==r.Name or r.Name==nil then if not r.Validator or r.Validator(t)then local u=ESP:Add(t,{PrimaryPart=type(r.PrimaryPart)=="string"and t:WaitForChild(r.PrimaryPart)or type(r.PrimaryPart)=="function"and r.PrimaryPart(t),Color=type(r.Color)=="function"and r.Color(t)or r.Color,ColorDynamic=r.ColorDynamic,Name=type(r.CustomName)=="function"and r.CustomName(t)or r.CustomName,IsEnabled=r.IsEnabled,RenderInNil=r.RenderInNil})if r.OnAdded then coroutine.wrap(r.OnAdded)(u)end end end end end;if r.Recursive then q.DescendantAdded:Connect(s)for k,l in pairs(q:GetDescendants())do coroutine.wrap(s)(l)end else q.ChildAdded:Connect(s)for k,l in pairs(q:GetChildren())do coroutine.wrap(s)(l)end end end;local v={}v.__index=v;function v:Remove()ESP.Objects[self.Object]=nil;for k,l in pairs(self.Components)do l.Visible=false;l:Remove()self.Components[k]=nil end end;function v:Update()if not self.PrimaryPart then return self:Remove()end;local color;if ESP.Highlighted==self.Object then color=ESP.HighlightColor else color=self.Color or self.ColorDynamic and self:ColorDynamic()or ESP:GetColor(self.Object)or ESP.Color end;local w=true;if ESP.Overrides.UpdateAllow and not ESP.Overrides.UpdateAllow(self)then w=false end;if self.Player and not ESP.TeamMates and ESP:IsTeamMate(self.Player)then w=false end;if self.Player and not ESP.Players then w=false end;if self.IsEnabled and(type(self.IsEnabled)=="string"and not ESP[self.IsEnabled]or type(self.IsEnabled)=="function"and not self:IsEnabled())then w=false end;if not workspace:IsAncestorOf(self.PrimaryPart)and not self.RenderInNil then w=false end;if not w then for k,l in pairs(self.Components)do l.Visible=false end;return end;if ESP.Highlighted==self.Object then color=ESP.HighlightColor end;local x=self.PrimaryPart.CFrame;if ESP.FaceCamera then x=CFrame.new(x.p,a.CFrame.p)end;local y=self.Size;local z={TopLeft=x*ESP.BoxShift*CFrame.new(y.X/2,y.Y/2,0),TopRight=x*ESP.BoxShift*CFrame.new(-y.X/2,y.Y/2,0),BottomLeft=x*ESP.BoxShift*CFrame.new(y.X/2,-y.Y/2,0),BottomRight=x*ESP.BoxShift*CFrame.new(-y.X/2,-y.Y/2,0),TagPos=x*ESP.BoxShift*CFrame.new(0,y.Y/2,0),Torso=x*ESP.BoxShift}if ESP.Boxes then local A,B=f(a,z.TopLeft.p)local C,D=f(a,z.TopRight.p)local E,F=f(a,z.BottomLeft.p)local G,H=f(a,z.BottomRight.p)if self.Components.Quad then if B or D or F or H then self.Components.Quad.Visible=true;self.Components.Quad.PointA=Vector2.new(C.X,C.Y)self.Components.Quad.PointB=Vector2.new(A.X,A.Y)self.Components.Quad.PointC=Vector2.new(E.X,E.Y)self.Components.Quad.PointD=Vector2.new(G.X,G.Y)self.Components.Quad.Color=color else self.Components.Quad.Visible=false end end else self.Components.Quad.Visible=false end;if ESP.Names then local I,J=f(a,z.TagPos.p)if J then self.Components.Name.Visible=true;self.Components.Name.Position=Vector2.new(I.X,I.Y)self.Components.Name.Text=self.Name;self.Components.Name.Color=color;self.Components.Distance.Visible=true;self.Components.Distance.Position=Vector2.new(I.X,I.Y+14)self.Components.Distance.Text=math.floor((a.CFrame.p-x.p).magnitude).."m away"self.Components.Distance.Color=color else self.Components.Name.Visible=false;self.Components.Distance.Visible=false end else self.Components.Name.Visible=false;self.Components.Distance.Visible=false end;if ESP.Tracers then local K,L=f(a,z.Torso.p)if L then self.Components.Tracer.Visible=true;self.Components.Tracer.From=Vector2.new(K.X,K.Y)self.Components.Tracer.To=Vector2.new(a.ViewportSize.X/2,a.ViewportSize.Y/ESP.AttachShift)self.Components.Tracer.Color=color else self.Components.Tracer.Visible=false end else self.Components.Tracer.Visible=false end end;function ESP:Add(h,r)if not h.Parent and not r.RenderInNil then return warn(h,"has no parent")end;local u=setmetatable({Name=r.Name or h.Name,Type="Box",Color=r.Color,Size=r.Size or self.BoxSize,Object=h,Player=r.Player or b:GetPlayerFromCharacter(h),PrimaryPart=r.PrimaryPart or h.ClassName=="Model"and(h.PrimaryPart or h:FindFirstChild("HumanoidRootPart")or h:FindFirstChildWhichIsA("BasePart"))or h:IsA("BasePart")and h,Components={},IsEnabled=r.IsEnabled,Temporary=r.Temporary,ColorDynamic=r.ColorDynamic,RenderInNil=r.RenderInNil},v)if self:GetBox(h)then self:GetBox(h):Remove()end;u.Components["Quad"]=g("Quad",{Thickness=self.Thickness,Color=color,Transparency=1,Filled=false,Visible=self.Enabled and self.Boxes})u.Components["Name"]=g("Text",{Text=u.Name,Color=u.Color,Center=true,Outline=true,Size=19,Visible=self.Enabled and self.Names})u.Components["Distance"]=g("Text",{Color=u.Color,Center=true,Outline=true,Size=19,Visible=self.Enabled and self.Names})u.Components["Tracer"]=g("Line",{Thickness=ESP.Thickness,Color=u.Color,Transparency=1,Visible=self.Enabled and self.Tracers})self.Objects[h]=u;h.AncestryChanged:Connect(function(M,q)if q==nil and ESP.AutoRemove~=false then u:Remove()end end)h:GetPropertyChangedSignal("Parent"):Connect(function()if h.Parent==nil and ESP.AutoRemove~=false then u:Remove()end end)local N=h:FindFirstChildOfClass("Humanoid")if N then N.Died:Connect(function()if ESP.AutoRemove~=false then u:Remove()end end)end;return u end;local function O(o)local m=b:GetPlayerFromCharacter(o)if not o:FindFirstChild("HumanoidRootPart")then local P;P=o.ChildAdded:Connect(function(t)if t.Name=="HumanoidRootPart"then P:Disconnect()ESP:Add(o,{Name=m.Name,Player=m,PrimaryPart=t})end end)else ESP:Add(o,{Name=m.Name,Player=m,PrimaryPart=o.HumanoidRootPart})end end;local function Q(m)m.CharacterAdded:Connect(O)if m.Character then coroutine.wrap(O)(m.Character)end end;b.PlayerAdded:Connect(Q)for k,l in pairs(b:GetPlayers())do if l~=c then Q(l)end end;game:GetService("RunService").RenderStepped:Connect(function()a=workspace.CurrentCamera;for k,l in(ESP.Enabled and pairs or ipairs)(ESP.Objects)do if l.Update then local R,S=pcall(l.Update,l)if not R then warn("[EU]",S,l.Object:GetFullName())end end end end)return ESP
